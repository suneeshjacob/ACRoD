from src.functions import jacobian

import numpy

def test_planar_3Rs():
    A = numpy.matrix('9 1 0 0;1 9 1 0;0 1 9 1;0 0 1 9')
    jac = jacobian(A, robot_type = 'planar')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[-a_y + r_{(1,2)y}, -a_y + r_{(2,3)y}, -a_y + r_{(3,4)y}],\n[ a_x - r_{(1,2)x},  a_x - r_{(2,3)x},  a_x - r_{(3,4)x}],\n[                1,                 1,                 1]]), None, None, None]'

def test_planar_3RPRp():
    A = numpy.matrix('9 1 0 1 0 1 0 0;0 9 2 0 0 0 0 0;0 1 9 0 0 0 0 1;0 0 0 9 2 0 0 0;0 0 0 1 9 0 0 1;0 0 0 0 0 9 2 0;0 0 0 0 0 1 9 1;0 0 0 0 0 0 0 9')
    jac = jacobian(A, robot_type = 'planar')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[cos(\\phi_{(2,3)}), 0, 0],\n[sin(\\phi_{(2,3)}), 0, 0],\n[                0, 0, 0]]), Matrix([\n[-a_y + r_{(1,2)y}, 0, 0, -a_y + r_{(3,8)y}, 0, 0],\n[ a_x - r_{(1,2)x}, 0, 0,  a_x - r_{(3,8)x}, 0, 0],\n[                1, 0, 0,                 1, 0, 0]]), Matrix([\n[-cos(\\phi_{(2,3)}), cos(\\phi_{(4,5)}),                 0],\n[-sin(\\phi_{(2,3)}), sin(\\phi_{(4,5)}),                 0],\n[-cos(\\phi_{(2,3)}),                 0, cos(\\phi_{(6,7)})],\n[-sin(\\phi_{(2,3)}),                 0, sin(\\phi_{(6,7)})],\n[                 0,                 0,                 0],\n[                 0,                 0,                 0]]), Matrix([\n[ a_y - r_{(1,2)y}, -a_y + r_{(1,4)y},                 0,  a_y - r_{(3,8)y}, -a_y + r_{(5,8)y},                 0],\n[-a_x + r_{(1,2)x},  a_x - r_{(1,4)x},                 0, -a_x + r_{(3,8)x},  a_x - r_{(5,8)x},                 0],\n[ a_y - r_{(1,2)y},                 0, -a_y + r_{(1,6)y},  a_y - r_{(3,8)y},                 0, -a_y + r_{(7,8)y}],\n[-a_x + r_{(1,2)x},                 0,  a_x - r_{(1,6)x}, -a_x + r_{(3,8)x},                 0,  a_x - r_{(7,8)x}],\n[               -1,                 1,                 0,                -1,                 1,                 0],\n[               -1,                 0,                 1,                -1,                 0,                 1]])]'
    
def test_planar_5Rp():
    A = numpy.matrix('9 1 0 1 0;1 9 1 0 0;0 0 9 0 1;1 0 0 9 1;0 0 0 0 9')
    jac = jacobian(A, robot_type = 'planar')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[0, -a_y + r_{(1,4)y}],\n[0,  a_x - r_{(1,4)x}],\n[0,                 1]]), Matrix([\n[0, 0, -a_y + r_{(4,5)y}],\n[0, 0,  a_x - r_{(4,5)x}],\n[0, 0,                 1]]), Matrix([\n[-a_y + r_{(1,2)y},  a_y - r_{(1,4)y}],\n[ a_x - r_{(1,2)x}, -a_x + r_{(1,4)x}],\n[                1,                -1]]), Matrix([\n[-a_y + r_{(2,3)y}, -a_y + r_{(3,5)y},  a_y - r_{(4,5)y}],\n[ a_x - r_{(2,3)x},  a_x - r_{(3,5)x}, -a_x + r_{(4,5)x}],\n[                1,                 1,                -1]])]'

def test_planar_4R4Psp():
    A = numpy.matrix('9 2 2 0 0 0 0;1 9 0 2 0 0 0;1 0 9 2 0 0 0;0 0 0 9 1 1 0;0 0 0 1 9 0 1;0 0 0 0 0 9 1;0 0 0 0 0 0 9')
    jac = jacobian(A, robot_type = 'planar')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[cos(\\phi_{(1,2)}), 0, -a_y + r_{(4,5)y}],\n[sin(\\phi_{(1,2)}), 0,  a_x - r_{(4,5)x}],\n[                0, 0,                 1]]), Matrix([\n[cos(\\phi_{(2,4)}), 0, 0, -a_y + r_{(5,7)y}, 0],\n[sin(\\phi_{(2,4)}), 0, 0,  a_x - r_{(5,7)x}, 0],\n[                0, 0, 0,                 1, 0]]), Matrix([\n[                 0,                 0,  a_y - r_{(4,5)y}],\n[                 0,                 0, -a_x + r_{(4,5)x}],\n[-cos(\\phi_{(1,2)}), cos(\\phi_{(1,3)}),                 0],\n[-sin(\\phi_{(1,2)}), sin(\\phi_{(1,3)}),                 0],\n[                 0,                 0,                -1]]), Matrix([\n[                 0,                 0, -a_y + r_{(4,6)y},  a_y - r_{(5,7)y}, -a_y + r_{(6,7)y}],\n[                 0,                 0,  a_x - r_{(4,6)x}, -a_x + r_{(5,7)x},  a_x - r_{(6,7)x}],\n[-cos(\\phi_{(2,4)}), cos(\\phi_{(3,4)}),                 0,                 0,                 0],\n[-sin(\\phi_{(2,4)}), sin(\\phi_{(3,4)}),                 0,                 0,                 0],\n[                 0,                 0,                 1,                -1,                 1]])]'

def test_spatial_6Rs():
    A = numpy.matrix('9 1 0 0 0 0 0;1 9 1 0 0 0 0;0 1 9 1 0 0 0;0 0 1 9 1 0 0;0 0 0 1 9 1 0;0 0 0 0 1 9 1;0 0 0 0 0 1 9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[                  -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                   -(a_y - r_{(2,3)y})*cos(\\beta_{(2,3)}) + (a_z - r_{(2,3)z})*sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                   -(a_y - r_{(3,4)y})*cos(\\beta_{(3,4)}) + (a_z - r_{(3,4)z})*sin(\\beta_{(3,4)})*sin(\\phi_{(3,4)}),                   -(a_y - r_{(4,5)y})*cos(\\beta_{(4,5)}) + (a_z - r_{(4,5)z})*sin(\\beta_{(4,5)})*sin(\\phi_{(4,5)}),                   -(a_y - r_{(5,6)y})*cos(\\beta_{(5,6)}) + (a_z - r_{(5,6)z})*sin(\\beta_{(5,6)})*sin(\\phi_{(5,6)}),                   -(a_y - r_{(6,7)y})*cos(\\beta_{(6,7)}) + (a_z - r_{(6,7)z})*sin(\\beta_{(6,7)})*sin(\\phi_{(6,7)})],\n[                   (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                    (a_x - r_{(2,3)x})*cos(\\beta_{(2,3)}) - (a_z - r_{(2,3)z})*sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                    (a_x - r_{(3,4)x})*cos(\\beta_{(3,4)}) - (a_z - r_{(3,4)z})*sin(\\beta_{(3,4)})*cos(\\phi_{(3,4)}),                    (a_x - r_{(4,5)x})*cos(\\beta_{(4,5)}) - (a_z - r_{(4,5)z})*sin(\\beta_{(4,5)})*cos(\\phi_{(4,5)}),                    (a_x - r_{(5,6)x})*cos(\\beta_{(5,6)}) - (a_z - r_{(5,6)z})*sin(\\beta_{(5,6)})*cos(\\phi_{(5,6)}),                    (a_x - r_{(6,7)x})*cos(\\beta_{(6,7)}) - (a_z - r_{(6,7)z})*sin(\\beta_{(6,7)})*cos(\\phi_{(6,7)})],\n[-(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(2,3)x})*sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}) + (a_y - r_{(2,3)y})*sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), -(a_x - r_{(3,4)x})*sin(\\beta_{(3,4)})*sin(\\phi_{(3,4)}) + (a_y - r_{(3,4)y})*sin(\\beta_{(3,4)})*cos(\\phi_{(3,4)}), -(a_x - r_{(4,5)x})*sin(\\beta_{(4,5)})*sin(\\phi_{(4,5)}) + (a_y - r_{(4,5)y})*sin(\\beta_{(4,5)})*cos(\\phi_{(4,5)}), -(a_x - r_{(5,6)x})*sin(\\beta_{(5,6)})*sin(\\phi_{(5,6)}) + (a_y - r_{(5,6)y})*sin(\\beta_{(5,6)})*cos(\\phi_{(5,6)}), -(a_x - r_{(6,7)x})*sin(\\beta_{(6,7)})*sin(\\phi_{(6,7)}) + (a_y - r_{(6,7)y})*sin(\\beta_{(6,7)})*cos(\\phi_{(6,7)})],\n[                                                                              sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                               sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                                                               sin(\\beta_{(3,4)})*cos(\\phi_{(3,4)}),                                                                               sin(\\beta_{(4,5)})*cos(\\phi_{(4,5)}),                                                                               sin(\\beta_{(5,6)})*cos(\\phi_{(5,6)}),                                                                               sin(\\beta_{(6,7)})*cos(\\phi_{(6,7)})],\n[                                                                              sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                               sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                                                               sin(\\beta_{(3,4)})*sin(\\phi_{(3,4)}),                                                                               sin(\\beta_{(4,5)})*sin(\\phi_{(4,5)}),                                                                               sin(\\beta_{(5,6)})*sin(\\phi_{(5,6)}),                                                                               sin(\\beta_{(6,7)})*sin(\\phi_{(6,7)})],\n[                                                                                                cos(\\beta_{(1,2)}),                                                                                                 cos(\\beta_{(2,3)}),                                                                                                 cos(\\beta_{(3,4)}),                                                                                                 cos(\\beta_{(4,5)}),                                                                                                 cos(\\beta_{(5,6)}),                                                                                                 cos(\\beta_{(6,7)})]]), None, None, None]'

def test_spatial_RSSRp():
    A = numpy.matrix('9 1 0 1;1 9 4 0;0 0 9 4;0 0 0 9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[0],\n[0],\n[0],\n[0],\n[0],\n[0]]), Matrix([\n[                  -(a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                   (a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[-(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) + (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                                                                                                cos(\\beta_{(1,4)}), 0, 0, 0, 0, 0, 0]]), Matrix([\n[                                                                              -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)})],\n[                                                                               (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)})],\n[                                                            -(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)})],\n[                                                                                                                                          sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)})],\n[                                                                                                                                          sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)})],\n[                                                                                                                                                            cos(\\beta_{(1,2)})],\n[(r_{(2,3)x} - r_{(3,4)x})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}) + (r_{(2,3)y} - r_{(3,4)y})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (r_{(2,3)z} - r_{(3,4)z})*cos(\\beta_{(1,2)})]]), Matrix([\n[                  (a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                       0,        a_z - r_{(2,3)z},       -a_y + r_{(2,3)y},                 0,  a_z - r_{(3,4)z}, -a_y + r_{(3,4)y}],\n[                 -(a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),       -a_z + r_{(2,3)z},                       0,        a_x - r_{(2,3)x}, -a_z + r_{(3,4)z},                 0,  a_x - r_{(3,4)x}],\n[(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) - (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),        a_y - r_{(2,3)y},       -a_x + r_{(2,3)x},                       0,  a_y - r_{(3,4)y}, -a_x + r_{(3,4)x},                 0],\n[                                                                            -sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                       1,                       0,                       0,                 1,                 0,                 0],\n[                                                                            -sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                       0,                       1,                       0,                 0,                 1,                 0],\n[                                                                                              -cos(\\beta_{(1,4)}),                       0,                       0,                       1,                 0,                 0,                 1],\n[                                                                                                                0, r_{(2,3)x} - r_{(3,4)x}, r_{(2,3)y} - r_{(3,4)y}, r_{(2,3)z} - r_{(3,4)z},                 0,                 0,                 0]])]'

def test_spatial_RSSRSSR():
    A = numpy.matrix('9 1 1 0 1 0;1 9 0 0 0 4;1 0 9 4 0 0;0 0 0 9 0 4;0 0 0 0 9 4;0 0 0 0 0 9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[                  -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), 0],\n[                   (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0],\n[-(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0],\n[                                                                              sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0],\n[                                                                              sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), 0],\n[                                                                                                cos(\\beta_{(1,2)}), 0]]), Matrix([\n[0,                 0,  a_z - r_{(2,6)z}, -a_y + r_{(2,6)y}, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[0, -a_z + r_{(2,6)z},                 0,  a_x - r_{(2,6)x}, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[0,  a_y - r_{(2,6)y}, -a_x + r_{(2,6)x},                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[0,                 1,                 0,                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[0,                 0,                 1,                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[0,                 0,                 0,                 1, 0, 0, 0, 0, 0, 0, 0, 0, 0]]), Matrix([\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                              0],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                              0],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                              0],\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                               -(a_y - r_{(1,3)y})*cos(\\beta_{(1,3)}) + (a_z - r_{(1,3)z})*sin(\\beta_{(1,3)})*sin(\\phi_{(1,3)})],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                (a_x - r_{(1,3)x})*cos(\\beta_{(1,3)}) - (a_z - r_{(1,3)z})*sin(\\beta_{(1,3)})*cos(\\phi_{(1,3)})],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                             -(a_x - r_{(1,3)x})*sin(\\beta_{(1,3)})*sin(\\phi_{(1,3)}) + (a_y - r_{(1,3)y})*sin(\\beta_{(1,3)})*cos(\\phi_{(1,3)})],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                              0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                              0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                                              0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                           sin(\\beta_{(1,3)})*cos(\\phi_{(1,3)})],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                           sin(\\beta_{(1,3)})*sin(\\phi_{(1,3)})],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                             cos(\\beta_{(1,3)})],\n[                                                                                                                0, (r_{(3,4)x} - r_{(4,6)x})*sin(\\beta_{(1,3)})*cos(\\phi_{(1,3)}) + (r_{(3,4)y} - r_{(4,6)y})*sin(\\beta_{(1,3)})*sin(\\phi_{(1,3)}) + (r_{(3,4)z} - r_{(4,6)z})*cos(\\beta_{(1,3)})]]), Matrix([\n[                  -(a_y - r_{(1,5)y})*cos(\\beta_{(1,5)}) + (a_z - r_{(1,5)z})*sin(\\beta_{(1,5)})*sin(\\phi_{(1,5)}),                 0, -a_z + r_{(2,6)z},  a_y - r_{(2,6)y},                       0,                       0,                       0,                 0,                 0,                 0,                 0,  a_z - r_{(5,6)z}, -a_y + r_{(5,6)y}],\n[                   (a_x - r_{(1,5)x})*cos(\\beta_{(1,5)}) - (a_z - r_{(1,5)z})*sin(\\beta_{(1,5)})*cos(\\phi_{(1,5)}),  a_z - r_{(2,6)z},                 0, -a_x + r_{(2,6)x},                       0,                       0,                       0,                 0,                 0,                 0, -a_z + r_{(5,6)z},                 0,  a_x - r_{(5,6)x}],\n[-(a_x - r_{(1,5)x})*sin(\\beta_{(1,5)})*sin(\\phi_{(1,5)}) + (a_y - r_{(1,5)y})*sin(\\beta_{(1,5)})*cos(\\phi_{(1,5)}), -a_y + r_{(2,6)y},  a_x - r_{(2,6)x},                 0,                       0,                       0,                       0,                 0,                 0,                 0,  a_y - r_{(5,6)y}, -a_x + r_{(5,6)x},                 0],\n[                                                                                                                 0,                 0, -a_z + r_{(2,6)z},  a_y - r_{(2,6)y},                       0,        a_z - r_{(3,4)z},       -a_y + r_{(3,4)y},                 0,  a_z - r_{(4,6)z}, -a_y + r_{(4,6)y},                 0,                 0,                 0],\n[                                                                                                                 0,  a_z - r_{(2,6)z},                 0, -a_x + r_{(2,6)x},       -a_z + r_{(3,4)z},                       0,        a_x - r_{(3,4)x}, -a_z + r_{(4,6)z},                 0,  a_x - r_{(4,6)x},                 0,                 0,                 0],\n[                                                                                                                 0, -a_y + r_{(2,6)y},  a_x - r_{(2,6)x},                 0,        a_y - r_{(3,4)y},       -a_x + r_{(3,4)x},                       0,  a_y - r_{(4,6)y}, -a_x + r_{(4,6)x},                 0,                 0,                 0,                 0],\n[                                                                              sin(\\beta_{(1,5)})*cos(\\phi_{(1,5)}),                -1,                 0,                 0,                       0,                       0,                       0,                 0,                 0,                 0,                 1,                 0,                 0],\n[                                                                              sin(\\beta_{(1,5)})*sin(\\phi_{(1,5)}),                 0,                -1,                 0,                       0,                       0,                       0,                 0,                 0,                 0,                 0,                 1,                 0],\n[                                                                                                cos(\\beta_{(1,5)}),                 0,                 0,                -1,                       0,                       0,                       0,                 0,                 0,                 0,                 0,                 0,                 1],\n[                                                                                                                 0,                -1,                 0,                 0,                       1,                       0,                       0,                 1,                 0,                 0,                 0,                 0,                 0],\n[                                                                                                                 0,                 0,                -1,                 0,                       0,                       1,                       0,                 0,                 1,                 0,                 0,                 0,                 0],\n[                                                                                                                 0,                 0,                 0,                -1,                       0,                       0,                       1,                 0,                 0,                 1,                 0,                 0,                 0],\n[                                                                                                                 0,                 0,                 0,                 0, r_{(3,4)x} - r_{(4,6)x}, r_{(3,4)y} - r_{(4,6)y}, r_{(3,4)z} - r_{(4,6)z},                 0,                 0,                 0,                 0,                 0,                 0]])]'

def test_spatial_6UPS():
    A = numpy.matrix('9 5 0 5 0 5 0 5 0 5 0 5 0 0;0 9 2 0 0 0 0 0 0 0 0 0 0 0;0 1 9 0 0 0 0 0 0 0 0 0 0 4;0 0 0 9 2 0 0 0 0 0 0 0 0 0;0 0 0 1 9 0 0 0 0 0 0 0 0 4;0 0 0 0 0 9 2 0 0 0 0 0 0 0;0 0 0 0 0 1 9 0 0 0 0 0 0 4;0 0 0 0 0 0 0 9 2 0 0 0 0 0;0 0 0 0 0 0 0 1 9 0 0 0 0 4;0 0 0 0 0 0 0 0 0 9 2 0 0 0;0 0 0 0 0 0 0 0 0 1 9 0 0 4;0 0 0 0 0 0 0 0 0 0 0 9 2 0;0 0 0 0 0 0 0 0 0 0 0 1 9 4;0 0 0 0 0 0 0 0 0 0 0 0 0 9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), 0, 0, 0, 0, 0],\n[sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}), 0, 0, 0, 0, 0],\n[                  cos(\\beta_{(2,3)}), 0, 0, 0, 0, 0],\n[                                   0, 0, 0, 0, 0, 0],\n[                                   0, 0, 0, 0, 0, 0],\n[                                   0, 0, 0, 0, 0, 0]]), Matrix([\n[                  -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                            -(a_y - r_{(1,2)y})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) - (a_z - r_{(1,2)z})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                  0,  a_z - r_{(3,14)z}, -a_y + r_{(3,14)y}, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[                   (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                             (a_x - r_{(1,2)x})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) + (a_z - r_{(1,2)z})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -a_z + r_{(3,14)z},                  0,  a_x - r_{(3,14)x}, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[-(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), (a_x - r_{(1,2)x})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})) - (a_y - r_{(1,2)y})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,  a_y - r_{(3,14)y}, -a_x + r_{(3,14)x},                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                                              -cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                  1,                  0,                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                                              -sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                  0,                  1,                  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],\n[                                                                                                cos(\\beta_{(1,2)}),                                                                                                                                                                                                                                                                         1/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)), 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                  0,                  0,                  1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]), Matrix([\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), sin(\\beta_{(4,5)})*cos(\\phi_{(4,5)}),                                    0,                                    0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}), sin(\\beta_{(4,5)})*sin(\\phi_{(4,5)}),                                    0,                                    0,                                        0,                                        0],\n[                  -cos(\\beta_{(2,3)}),                   cos(\\beta_{(4,5)}),                                    0,                                    0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                    0, sin(\\beta_{(6,7)})*cos(\\phi_{(6,7)}),                                    0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                    0, sin(\\beta_{(6,7)})*sin(\\phi_{(6,7)}),                                    0,                                        0,                                        0],\n[                  -cos(\\beta_{(2,3)}),                                    0,                   cos(\\beta_{(6,7)}),                                    0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                    0,                                    0, sin(\\beta_{(8,9)})*cos(\\phi_{(8,9)}),                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                    0,                                    0, sin(\\beta_{(8,9)})*sin(\\phi_{(8,9)}),                                        0,                                        0],\n[                  -cos(\\beta_{(2,3)}),                                    0,                                    0,                   cos(\\beta_{(8,9)}),                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                    0,                                    0,                                    0, sin(\\beta_{(10,11)})*cos(\\phi_{(10,11)}),                                        0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                    0,                                    0,                                    0, sin(\\beta_{(10,11)})*sin(\\phi_{(10,11)}),                                        0],\n[                  -cos(\\beta_{(2,3)}),                                    0,                                    0,                                    0,                     cos(\\beta_{(10,11)}),                                        0],\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                    0,                                    0,                                    0,                                        0, sin(\\beta_{(12,13)})*cos(\\phi_{(12,13)})],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                    0,                                    0,                                    0,                                        0, sin(\\beta_{(12,13)})*sin(\\phi_{(12,13)})],\n[                  -cos(\\beta_{(2,3)}),                                    0,                                    0,                                    0,                                        0,                     cos(\\beta_{(12,13)})],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                    0,                                        0,                                        0]]), Matrix([\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                              (a_y - r_{(1,2)y})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) + (a_z - r_{(1,2)z})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                   -(a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                                                                            -(a_y - r_{(1,4)y})/sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2)) - (a_z - r_{(1,4)z})*sin(\\delta_{(1,4)})/(sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2))*cos(\\delta_{(1,4)} - \\phi_{(1,4)})*tan(\\beta_{(1,4)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0, -a_z + r_{(3,14)z},  a_y - r_{(3,14)y},                  0,  a_z - r_{(5,14)z}, -a_y + r_{(5,14)y},                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                             -(a_x - r_{(1,2)x})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) - (a_z - r_{(1,2)z})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                    (a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                                                             (a_x - r_{(1,4)x})/sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2)) + (a_z - r_{(1,4)z})*cos(\\delta_{(1,4)})/(sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2))*cos(\\delta_{(1,4)} - \\phi_{(1,4)})*tan(\\beta_{(1,4)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,  a_z - r_{(3,14)z},                  0, -a_x + r_{(3,14)x}, -a_z + r_{(5,14)z},                  0,  a_x - r_{(5,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(1,2)x})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})) + (a_y - r_{(1,2)y})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})), -(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) + (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), (a_x - r_{(1,4)x})*sin(\\delta_{(1,4)})/(sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2))*cos(\\delta_{(1,4)} - \\phi_{(1,4)})*tan(\\beta_{(1,4)})) - (a_y - r_{(1,4)y})*cos(\\delta_{(1,4)})/(sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2))*cos(\\delta_{(1,4)} - \\phi_{(1,4)})*tan(\\beta_{(1,4)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0, -a_y + r_{(3,14)y},  a_x - r_{(3,14)x},                  0,  a_y - r_{(5,14)y}, -a_x + r_{(5,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                              (a_y - r_{(1,2)y})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) + (a_z - r_{(1,2)z})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                   -(a_y - r_{(1,6)y})*cos(\\beta_{(1,6)}) + (a_z - r_{(1,6)z})*sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}),                                                                            -(a_y - r_{(1,6)y})/sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2)) - (a_z - r_{(1,6)z})*sin(\\delta_{(1,6)})/(sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2))*cos(\\delta_{(1,6)} - \\phi_{(1,6)})*tan(\\beta_{(1,6)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0, -a_z + r_{(3,14)z},  a_y - r_{(3,14)y},                  0,                  0,                  0,                  0,  a_z - r_{(7,14)z}, -a_y + r_{(7,14)y},                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                             -(a_x - r_{(1,2)x})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) - (a_z - r_{(1,2)z})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                    (a_x - r_{(1,6)x})*cos(\\beta_{(1,6)}) - (a_z - r_{(1,6)z})*sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),                                                                             (a_x - r_{(1,6)x})/sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2)) + (a_z - r_{(1,6)z})*cos(\\delta_{(1,6)})/(sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2))*cos(\\delta_{(1,6)} - \\phi_{(1,6)})*tan(\\beta_{(1,6)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,  a_z - r_{(3,14)z},                  0, -a_x + r_{(3,14)x},                  0,                  0,                  0, -a_z + r_{(7,14)z},                  0,  a_x - r_{(7,14)x},                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(1,2)x})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})) + (a_y - r_{(1,2)y})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0, -(a_x - r_{(1,6)x})*sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}) + (a_y - r_{(1,6)y})*sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}), (a_x - r_{(1,6)x})*sin(\\delta_{(1,6)})/(sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2))*cos(\\delta_{(1,6)} - \\phi_{(1,6)})*tan(\\beta_{(1,6)})) - (a_y - r_{(1,6)y})*cos(\\delta_{(1,6)})/(sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2))*cos(\\delta_{(1,6)} - \\phi_{(1,6)})*tan(\\beta_{(1,6)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0, -a_y + r_{(3,14)y},  a_x - r_{(3,14)x},                  0,                  0,                  0,                  0,  a_y - r_{(7,14)y}, -a_x + r_{(7,14)x},                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                              (a_y - r_{(1,2)y})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) + (a_z - r_{(1,2)z})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                   -(a_y - r_{(1,8)y})*cos(\\beta_{(1,8)}) + (a_z - r_{(1,8)z})*sin(\\beta_{(1,8)})*sin(\\phi_{(1,8)}),                                                                            -(a_y - r_{(1,8)y})/sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2)) - (a_z - r_{(1,8)z})*sin(\\delta_{(1,8)})/(sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2))*cos(\\delta_{(1,8)} - \\phi_{(1,8)})*tan(\\beta_{(1,8)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0, -a_z + r_{(3,14)z},  a_y - r_{(3,14)y},                  0,                  0,                  0,                  0,                  0,                  0,                  0,  a_z - r_{(9,14)z}, -a_y + r_{(9,14)y},                   0,                   0,                   0,                   0,                   0,                   0],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                             -(a_x - r_{(1,2)x})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) - (a_z - r_{(1,2)z})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                    (a_x - r_{(1,8)x})*cos(\\beta_{(1,8)}) - (a_z - r_{(1,8)z})*sin(\\beta_{(1,8)})*cos(\\phi_{(1,8)}),                                                                             (a_x - r_{(1,8)x})/sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2)) + (a_z - r_{(1,8)z})*cos(\\delta_{(1,8)})/(sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2))*cos(\\delta_{(1,8)} - \\phi_{(1,8)})*tan(\\beta_{(1,8)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,  a_z - r_{(3,14)z},                  0, -a_x + r_{(3,14)x},                  0,                  0,                  0,                  0,                  0,                  0, -a_z + r_{(9,14)z},                  0,  a_x - r_{(9,14)x},                   0,                   0,                   0,                   0,                   0,                   0],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(1,2)x})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})) + (a_y - r_{(1,2)y})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0, -(a_x - r_{(1,8)x})*sin(\\beta_{(1,8)})*sin(\\phi_{(1,8)}) + (a_y - r_{(1,8)y})*sin(\\beta_{(1,8)})*cos(\\phi_{(1,8)}), (a_x - r_{(1,8)x})*sin(\\delta_{(1,8)})/(sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2))*cos(\\delta_{(1,8)} - \\phi_{(1,8)})*tan(\\beta_{(1,8)})) - (a_y - r_{(1,8)y})*cos(\\delta_{(1,8)})/(sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2))*cos(\\delta_{(1,8)} - \\phi_{(1,8)})*tan(\\beta_{(1,8)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0, -a_y + r_{(3,14)y},  a_x - r_{(3,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                  0,  a_y - r_{(9,14)y}, -a_x + r_{(9,14)x},                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                              (a_y - r_{(1,2)y})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) + (a_z - r_{(1,2)z})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                    -(a_y - r_{(1,10)y})*cos(\\beta_{(1,10)}) + (a_z - r_{(1,10)z})*sin(\\beta_{(1,10)})*sin(\\phi_{(1,10)}),                                                                                -(a_y - r_{(1,10)y})/sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2)) - (a_z - r_{(1,10)z})*sin(\\delta_{(1,10)})/(sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2))*cos(\\delta_{(1,10)} - \\phi_{(1,10)})*tan(\\beta_{(1,10)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0, -a_z + r_{(3,14)z},  a_y - r_{(3,14)y},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,  a_z - r_{(11,14)z}, -a_y + r_{(11,14)y},                   0,                   0,                   0],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                             -(a_x - r_{(1,2)x})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) - (a_z - r_{(1,2)z})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                     (a_x - r_{(1,10)x})*cos(\\beta_{(1,10)}) - (a_z - r_{(1,10)z})*sin(\\beta_{(1,10)})*cos(\\phi_{(1,10)}),                                                                                 (a_x - r_{(1,10)x})/sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2)) + (a_z - r_{(1,10)z})*cos(\\delta_{(1,10)})/(sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2))*cos(\\delta_{(1,10)} - \\phi_{(1,10)})*tan(\\beta_{(1,10)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,  a_z - r_{(3,14)z},                  0, -a_x + r_{(3,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0, -a_z + r_{(11,14)z},                   0,  a_x - r_{(11,14)x},                   0,                   0,                   0],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(1,2)x})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})) + (a_y - r_{(1,2)y})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0, -(a_x - r_{(1,10)x})*sin(\\beta_{(1,10)})*sin(\\phi_{(1,10)}) + (a_y - r_{(1,10)y})*sin(\\beta_{(1,10)})*cos(\\phi_{(1,10)}), (a_x - r_{(1,10)x})*sin(\\delta_{(1,10)})/(sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2))*cos(\\delta_{(1,10)} - \\phi_{(1,10)})*tan(\\beta_{(1,10)})) - (a_y - r_{(1,10)y})*cos(\\delta_{(1,10)})/(sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2))*cos(\\delta_{(1,10)} - \\phi_{(1,10)})*tan(\\beta_{(1,10)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0, -a_y + r_{(3,14)y},  a_x - r_{(3,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,  a_y - r_{(11,14)y}, -a_x + r_{(11,14)x},                   0,                   0,                   0,                   0],\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                              (a_y - r_{(1,2)y})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) + (a_z - r_{(1,2)z})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                    -(a_y - r_{(1,12)y})*cos(\\beta_{(1,12)}) + (a_z - r_{(1,12)z})*sin(\\beta_{(1,12)})*sin(\\phi_{(1,12)}),                                                                                -(a_y - r_{(1,12)y})/sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2)) - (a_z - r_{(1,12)z})*sin(\\delta_{(1,12)})/(sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2))*cos(\\delta_{(1,12)} - \\phi_{(1,12)})*tan(\\beta_{(1,12)})),                  0, -a_z + r_{(3,14)z},  a_y - r_{(3,14)y},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,  a_z - r_{(13,14)z}, -a_y + r_{(13,14)y}],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                             -(a_x - r_{(1,2)x})/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)) - (a_z - r_{(1,2)z})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                     (a_x - r_{(1,12)x})*cos(\\beta_{(1,12)}) - (a_z - r_{(1,12)z})*sin(\\beta_{(1,12)})*cos(\\phi_{(1,12)}),                                                                                 (a_x - r_{(1,12)x})/sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2)) + (a_z - r_{(1,12)z})*cos(\\delta_{(1,12)})/(sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2))*cos(\\delta_{(1,12)} - \\phi_{(1,12)})*tan(\\beta_{(1,12)})),  a_z - r_{(3,14)z},                  0, -a_x + r_{(3,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0, -a_z + r_{(13,14)z},                   0,  a_x - r_{(13,14)x}],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(1,2)x})*sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})) + (a_y - r_{(1,2)y})*cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0, -(a_x - r_{(1,12)x})*sin(\\beta_{(1,12)})*sin(\\phi_{(1,12)}) + (a_y - r_{(1,12)y})*sin(\\beta_{(1,12)})*cos(\\phi_{(1,12)}), (a_x - r_{(1,12)x})*sin(\\delta_{(1,12)})/(sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2))*cos(\\delta_{(1,12)} - \\phi_{(1,12)})*tan(\\beta_{(1,12)})) - (a_y - r_{(1,12)y})*cos(\\delta_{(1,12)})/(sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2))*cos(\\delta_{(1,12)} - \\phi_{(1,12)})*tan(\\beta_{(1,12)})), -a_y + r_{(3,14)y},  a_x - r_{(3,14)x},                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,  a_y - r_{(13,14)y}, -a_x + r_{(13,14)x},                   0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                                                cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                               sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                                                                                                                                                                              -cos(\\delta_{(1,4)})/(sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2))*cos(\\delta_{(1,4)} - \\phi_{(1,4)})*tan(\\beta_{(1,4)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                 -1,                  0,                  0,                  1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                                                sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                               sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                                                                                                                                                                                              -sin(\\delta_{(1,4)})/(sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2))*cos(\\delta_{(1,4)} - \\phi_{(1,4)})*tan(\\beta_{(1,4)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                 -1,                  0,                  0,                  1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                                                                                                                                         -1/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)),                                                                                                 cos(\\beta_{(1,4)}),                                                                                                                                                                                                                                                                         1/sqrt(1 + 1/(cos(\\delta_{(1,4)} - \\phi_{(1,4)})**2*tan(\\beta_{(1,4)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                  0,                 -1,                  0,                  0,                  1,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                                                cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                               sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),                                                                                                                                                                                              -cos(\\delta_{(1,6)})/(sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2))*cos(\\delta_{(1,6)} - \\phi_{(1,6)})*tan(\\beta_{(1,6)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                 -1,                  0,                  0,                  0,                  0,                  0,                  1,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                                                sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                               sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}),                                                                                                                                                                                              -sin(\\delta_{(1,6)})/(sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2))*cos(\\delta_{(1,6)} - \\phi_{(1,6)})*tan(\\beta_{(1,6)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  1,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                                                                                                                                         -1/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                 cos(\\beta_{(1,6)}),                                                                                                                                                                                                                                                                         1/sqrt(1 + 1/(cos(\\delta_{(1,6)} - \\phi_{(1,6)})**2*tan(\\beta_{(1,6)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  1,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                                                cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                               sin(\\beta_{(1,8)})*cos(\\phi_{(1,8)}),                                                                                                                                                                                              -cos(\\delta_{(1,8)})/(sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2))*cos(\\delta_{(1,8)} - \\phi_{(1,8)})*tan(\\beta_{(1,8)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  1,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                                                sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                               sin(\\beta_{(1,8)})*sin(\\phi_{(1,8)}),                                                                                                                                                                                              -sin(\\delta_{(1,8)})/(sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2))*cos(\\delta_{(1,8)} - \\phi_{(1,8)})*tan(\\beta_{(1,8)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  1,                  0,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                                                                                                                                         -1/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                 cos(\\beta_{(1,8)}),                                                                                                                                                                                                                                                                         1/sqrt(1 + 1/(cos(\\delta_{(1,8)} - \\phi_{(1,8)})**2*tan(\\beta_{(1,8)})**2)),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  1,                   0,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                                                cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                   sin(\\beta_{(1,10)})*cos(\\phi_{(1,10)}),                                                                                                                                                                                                       -cos(\\delta_{(1,10)})/(sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2))*cos(\\delta_{(1,10)} - \\phi_{(1,10)})*tan(\\beta_{(1,10)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   1,                   0,                   0,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                                                sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                   sin(\\beta_{(1,10)})*sin(\\phi_{(1,10)}),                                                                                                                                                                                                       -sin(\\delta_{(1,10)})/(sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2))*cos(\\delta_{(1,10)} - \\phi_{(1,10)})*tan(\\beta_{(1,10)})),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   1,                   0,                   0,                   0,                   0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                                                                                                                                         -1/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                      cos(\\beta_{(1,10)}),                                                                                                                                                                                                                                                                                      1/sqrt(1 + 1/(cos(\\delta_{(1,10)} - \\phi_{(1,10)})**2*tan(\\beta_{(1,10)})**2)),                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                  0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   1,                   0,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                                                                                                cos(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                   sin(\\beta_{(1,12)})*cos(\\phi_{(1,12)}),                                                                                                                                                                                                       -cos(\\delta_{(1,12)})/(sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2))*cos(\\delta_{(1,12)} - \\phi_{(1,12)})*tan(\\beta_{(1,12)})),                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   1,                   0,                   0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                                                                                                sin(\\delta_{(1,2)})/(sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2))*cos(\\delta_{(1,2)} - \\phi_{(1,2)})*tan(\\beta_{(1,2)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                   sin(\\beta_{(1,12)})*sin(\\phi_{(1,12)}),                                                                                                                                                                                                       -sin(\\delta_{(1,12)})/(sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2))*cos(\\delta_{(1,12)} - \\phi_{(1,12)})*tan(\\beta_{(1,12)})),                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   1,                   0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                                                                                                                                                                                                                                                         -1/sqrt(1 + 1/(cos(\\delta_{(1,2)} - \\phi_{(1,2)})**2*tan(\\beta_{(1,2)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                      cos(\\beta_{(1,12)}),                                                                                                                                                                                                                                                                                      1/sqrt(1 + 1/(cos(\\delta_{(1,12)} - \\phi_{(1,12)})**2*tan(\\beta_{(1,12)})**2)),                  0,                  0,                 -1,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                  0,                   0,                   0,                   0,                   0,                   0,                   1]])]'
    
def test_spatial_SPM():
    A = numpy.matrix('9,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0;0,9,2,0,0,0,0,0,0,0,0,0,0,0,0,0;0,1,9,0,0,0,0,4,0,0,0,0,0,0,0,0;0,0,0,9,2,0,0,0,0,0,0,0,0,0,0,0;0,0,0,1,9,0,0,4,0,0,0,0,0,0,0,0;0,0,0,0,0,9,2,0,0,0,0,0,0,0,0,0;0,0,0,0,0,1,9,4,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,9,4,0,4,0,4,0,5,0;0,0,0,0,0,0,0,0,9,2,0,0,0,0,0,0;0,0,0,0,0,0,0,0,1,9,0,0,0,0,0,4;0,0,0,0,0,0,0,0,0,0,9,2,0,0,0,0;0,0,0,0,0,0,0,0,0,0,1,9,0,0,0,4;0,0,0,0,0,0,0,0,0,0,0,0,9,2,0,0;0,0,0,0,0,0,0,0,0,0,0,0,1,9,0,4;0,0,0,0,0,0,0,0,0,0,0,0,0,0,9,2;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), 0, 0, 0, 0, 0],\n[sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}), 0, 0, 0, 0, 0],\n[                  cos(\\beta_{(2,3)}), 0, 0, 0, 0, 0],\n[                                   0, 0, 0, 0, 0, 0],\n[                                   0, 0, 0, 0, 0, 0],\n[                                   0, 0, 0, 0, 0, 0]]), Matrix([\n[                  -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), 0, 0,                 0,  a_z - r_{(3,8)z}, -a_y + r_{(3,8)y}, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                    -(a_y - r_{(8,15)y})*cos(\\beta_{(8,15)}) + (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                -(a_y - r_{(8,15)y})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) - (a_z - r_{(8,15)z})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, sin(\\beta_{(15,16)})*cos(\\phi_{(15,16)})],\n[                   (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0, 0, -a_z + r_{(3,8)z},                 0,  a_x - r_{(3,8)x}, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                     (a_x - r_{(8,15)x})*cos(\\beta_{(8,15)}) - (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                 (a_x - r_{(8,15)x})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) + (a_z - r_{(8,15)z})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})), 0, 0, 0, 0, 0, 0, 0, 0, 0, sin(\\beta_{(15,16)})*sin(\\phi_{(15,16)})],\n[-(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0, 0,  a_y - r_{(3,8)y}, -a_x + r_{(3,8)x},                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -(a_x - r_{(8,15)x})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}) + (a_y - r_{(8,15)y})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}), (a_x - r_{(8,15)x})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})) - (a_y - r_{(8,15)y})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})), 0, 0, 0, 0, 0, 0, 0, 0, 0,                     cos(\\beta_{(15,16)})],\n[                                                                              sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0, 0,                 1,                 0,                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                                                                                   sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                                                                                                                                       -cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})), 0, 0, 0, 0, 0, 0, 0, 0, 0,                                        0],\n[                                                                              sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), 0, 0,                 0,                 1,                 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                                                                                   sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                                                                                                                                       -sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})), 0, 0, 0, 0, 0, 0, 0, 0, 0,                                        0],\n[                                                                                                cos(\\beta_{(1,2)}), 0, 0,                 0,                 0,                 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,                                                                                                      cos(\\beta_{(8,15)}),                                                                                                                                                                                                                                                                                      1/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)), 0, 0, 0, 0, 0, 0, 0, 0, 0,                                        0]]), Matrix([\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), sin(\\beta_{(4,5)})*cos(\\phi_{(4,5)}),                                    0,                                      0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}), sin(\\beta_{(4,5)})*sin(\\phi_{(4,5)}),                                    0,                                      0,                                        0,                                        0],\n[                  -cos(\\beta_{(2,3)}),                   cos(\\beta_{(4,5)}),                                    0,                                      0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                    0, sin(\\beta_{(6,7)})*cos(\\phi_{(6,7)}),                                      0,                                        0,                                        0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                    0, sin(\\beta_{(6,7)})*sin(\\phi_{(6,7)}),                                      0,                                        0,                                        0],\n[                  -cos(\\beta_{(2,3)}),                                    0,                   cos(\\beta_{(6,7)}),                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0, sin(\\beta_{(9,10)})*cos(\\phi_{(9,10)}),                                        0,                                        0],\n[                                    0,                                    0,                                    0, sin(\\beta_{(9,10)})*sin(\\phi_{(9,10)}),                                        0,                                        0],\n[                                    0,                                    0,                                    0,                    cos(\\beta_{(9,10)}),                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0, sin(\\beta_{(11,12)})*cos(\\phi_{(11,12)}),                                        0],\n[                                    0,                                    0,                                    0,                                      0, sin(\\beta_{(11,12)})*sin(\\phi_{(11,12)}),                                        0],\n[                                    0,                                    0,                                    0,                                      0,                     cos(\\beta_{(11,12)}),                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0, sin(\\beta_{(13,14)})*cos(\\phi_{(13,14)})],\n[                                    0,                                    0,                                    0,                                      0,                                        0, sin(\\beta_{(13,14)})*sin(\\phi_{(13,14)})],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                     cos(\\beta_{(13,14)})],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0],\n[                                    0,                                    0,                                    0,                                      0,                                        0,                                        0]]), Matrix([\n[                                                                                           (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                   -(a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                                                                                                                  0,                           0,           -a_z + r_{(3,8)z},            a_y - r_{(3,8)y},                 0,  a_z - r_{(5,8)z}, -a_y + r_{(5,8)y},                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                          -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                    (a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                                                                                                  0,            a_z - r_{(3,8)z},                           0,           -a_x + r_{(3,8)x}, -a_z + r_{(5,8)z},                 0,  a_x - r_{(5,8)x},                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                         (a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) + (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                                                                                                  0,           -a_y + r_{(3,8)y},            a_x - r_{(3,8)x},                           0,  a_y - r_{(5,8)y}, -a_x + r_{(5,8)x},                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                           (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                  0,                   -(a_y - r_{(1,6)y})*cos(\\beta_{(1,6)}) + (a_z - r_{(1,6)z})*sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}),                           0,           -a_z + r_{(3,8)z},            a_y - r_{(3,8)y},                 0,                 0,                 0,                 0,  a_z - r_{(7,8)z}, -a_y + r_{(7,8)y},                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                          -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                  0,                    (a_x - r_{(1,6)x})*cos(\\beta_{(1,6)}) - (a_z - r_{(1,6)z})*sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),            a_z - r_{(3,8)z},                           0,           -a_x + r_{(3,8)x},                 0,                 0,                 0, -a_z + r_{(7,8)z},                 0,  a_x - r_{(7,8)x},                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                         (a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                  0, -(a_x - r_{(1,6)x})*sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}) + (a_y - r_{(1,6)y})*sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),           -a_y + r_{(3,8)y},            a_x - r_{(3,8)x},                           0,                 0,                 0,                 0,  a_y - r_{(7,8)y}, -a_x + r_{(7,8)x},                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,           a_z - r_{(8,9)z},          -a_y + r_{(8,9)y},                           0,                           0,                           0,                           0,                           0,                           0,                    (a_y - r_{(8,15)y})*cos(\\beta_{(8,15)}) - (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                  (a_y - r_{(8,15)y})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) + (a_z - r_{(8,15)z})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,  a_z - r_{(10,16)z}, -a_y + r_{(10,16)y},                   0,                   0,                   0,                   0,                   0,                   0, -sin(\\beta_{(15,16)})*cos(\\phi_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,          -a_z + r_{(8,9)z},                          0,           a_x - r_{(8,9)x},                           0,                           0,                           0,                           0,                           0,                           0,                   -(a_x - r_{(8,15)x})*cos(\\beta_{(8,15)}) + (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                 -(a_x - r_{(8,15)x})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) - (a_z - r_{(8,15)z})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})), -a_z + r_{(10,16)z},                   0,  a_x - r_{(10,16)x},                   0,                   0,                   0,                   0,                   0,                   0, -sin(\\beta_{(15,16)})*sin(\\phi_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,           a_y - r_{(8,9)y},          -a_x + r_{(8,9)x},                          0,                           0,                           0,                           0,                           0,                           0,                           0, (a_x - r_{(8,15)x})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}) - (a_y - r_{(8,15)y})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}), -(a_x - r_{(8,15)x})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})) + (a_y - r_{(8,15)y})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),  a_y - r_{(10,16)y}, -a_x + r_{(10,16)x},                   0,                   0,                   0,                   0,                   0,                   0,                   0,                     -cos(\\beta_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,           a_z - r_{(8,11)z},          -a_y + r_{(8,11)y},                           0,                           0,                           0,                    (a_y - r_{(8,15)y})*cos(\\beta_{(8,15)}) - (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                  (a_y - r_{(8,15)y})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) + (a_z - r_{(8,15)z})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,  a_z - r_{(12,16)z}, -a_y + r_{(12,16)y},                   0,                   0,                   0, -sin(\\beta_{(15,16)})*cos(\\phi_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,          -a_z + r_{(8,11)z},                           0,           a_x - r_{(8,11)x},                           0,                           0,                           0,                   -(a_x - r_{(8,15)x})*cos(\\beta_{(8,15)}) + (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                 -(a_x - r_{(8,15)x})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) - (a_z - r_{(8,15)z})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0, -a_z + r_{(12,16)z},                   0,  a_x - r_{(12,16)x},                   0,                   0,                   0, -sin(\\beta_{(15,16)})*sin(\\phi_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,           a_y - r_{(8,11)y},          -a_x + r_{(8,11)x},                           0,                           0,                           0,                           0, (a_x - r_{(8,15)x})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}) - (a_y - r_{(8,15)y})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}), -(a_x - r_{(8,15)x})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})) + (a_y - r_{(8,15)y})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,  a_y - r_{(12,16)y}, -a_x + r_{(12,16)x},                   0,                   0,                   0,                   0,                     -cos(\\beta_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,           a_z - r_{(8,13)z},          -a_y + r_{(8,13)y},                    (a_y - r_{(8,15)y})*cos(\\beta_{(8,15)}) - (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                  (a_y - r_{(8,15)y})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) + (a_z - r_{(8,15)z})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,                   0,                   0,                   0,  a_z - r_{(14,16)z}, -a_y + r_{(14,16)y}, -sin(\\beta_{(15,16)})*cos(\\phi_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,          -a_z + r_{(8,13)z},                           0,           a_x - r_{(8,13)x},                   -(a_x - r_{(8,15)x})*cos(\\beta_{(8,15)}) + (a_z - r_{(8,15)z})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                 -(a_x - r_{(8,15)x})/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)) - (a_z - r_{(8,15)z})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,                   0,                   0, -a_z + r_{(14,16)z},                   0,  a_x - r_{(14,16)x}, -sin(\\beta_{(15,16)})*sin(\\phi_{(15,16)})],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,           a_y - r_{(8,13)y},          -a_x + r_{(8,13)x},                           0, (a_x - r_{(8,15)x})*sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}) - (a_y - r_{(8,15)y})*sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}), -(a_x - r_{(8,15)x})*sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})) + (a_y - r_{(8,15)y})*cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,                   0,                   0,  a_y - r_{(14,16)y}, -a_x + r_{(14,16)x},                   0,                     -cos(\\beta_{(15,16)})],\n[                                                                                                                                                     -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                               sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                                                                                                  0,                          -1,                           0,                           0,                 1,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                     -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                               sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                                                                                                                  0,                           0,                          -1,                           0,                 0,                 1,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                       -cos(\\beta_{(1,2)}),                                                                                                 cos(\\beta_{(1,4)}),                                                                                                                  0,                           0,                           0,                          -1,                 0,                 0,                 1,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                     -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                  0,                                                                               sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),                          -1,                           0,                           0,                 0,                 0,                 0,                 1,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                     -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                  0,                                                                               sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}),                           0,                          -1,                           0,                 0,                 0,                 0,                 0,                 1,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                       -cos(\\beta_{(1,2)}),                                                                                                                  0,                                                                                                 cos(\\beta_{(1,6)}),                           0,                           0,                          -1,                 0,                 0,                 0,                 0,                 0,                 1,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          1,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                 -sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                                                                                                                                         cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   1,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          1,                          0,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                 -sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                                                                                                                                         sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   1,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          1,                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                    -cos(\\beta_{(8,15)}),                                                                                                                                                                                                                                                                                      -1/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)),                   0,                   0,                   1,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           1,                           0,                           0,                           0,                           0,                           0,                                                                                 -sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                                                                                                                                         cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   1,                   0,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           1,                           0,                           0,                           0,                           0,                                                                                 -sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                                                                                                                                         sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,                   1,                   0,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           1,                           0,                           0,                           0,                                                                                                    -cos(\\beta_{(8,15)}),                                                                                                                                                                                                                                                                                      -1/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)),                   0,                   0,                   0,                   0,                   0,                   1,                   0,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           1,                           0,                           0,                                                                                 -sin(\\beta_{(8,15)})*cos(\\phi_{(8,15)}),                                                                                                                                                                                                         cos(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,                   0,                   0,                   1,                   0,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           1,                           0,                                                                                 -sin(\\beta_{(8,15)})*sin(\\phi_{(8,15)}),                                                                                                                                                                                                         sin(\\delta_{(8,15)})/(sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2))*cos(\\delta_{(8,15)} - \\phi_{(8,15)})*tan(\\beta_{(8,15)})),                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   1,                   0,                                         0],\n[                                                                                                                                                                                         0,                                                                                                                  0,                                                                                                                  0,                           0,                           0,                           0,                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0,                           0,                           0,                           1,                                                                                                    -cos(\\beta_{(8,15)}),                                                                                                                                                                                                                                                                                      -1/sqrt(1 + 1/(cos(\\delta_{(8,15)} - \\phi_{(8,15)})**2*tan(\\beta_{(8,15)})**2)),                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   1,                                         0],\n[   (-r_{(10,16)x} + r_{(8,9)x})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}) + (-r_{(10,16)y} + r_{(8,9)y})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (-r_{(10,16)z} + r_{(8,9)z})*cos(\\beta_{(1,2)}),                                                                                                                  0,                                                                                                                  0,  -r_{(10,16)x} + r_{(8,9)x},  -r_{(10,16)y} + r_{(8,9)y},  -r_{(10,16)z} + r_{(8,9)z},                 0,                 0,                 0,                 0,                 0,                 0, -r_{(10,16)x} + r_{(8,9)x}, -r_{(10,16)y} + r_{(8,9)y}, -r_{(10,16)z} + r_{(8,9)z},                           0,                           0,                           0,                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[(-r_{(12,16)x} + r_{(8,11)x})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}) + (-r_{(12,16)y} + r_{(8,11)y})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (-r_{(12,16)z} + r_{(8,11)z})*cos(\\beta_{(1,2)}),                                                                                                                  0,                                                                                                                  0, -r_{(12,16)x} + r_{(8,11)x}, -r_{(12,16)y} + r_{(8,11)y}, -r_{(12,16)z} + r_{(8,11)z},                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0, -r_{(12,16)x} + r_{(8,11)x}, -r_{(12,16)y} + r_{(8,11)y}, -r_{(12,16)z} + r_{(8,11)z},                           0,                           0,                           0,                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0],\n[(-r_{(14,16)x} + r_{(8,13)x})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}) + (-r_{(14,16)y} + r_{(8,13)y})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (-r_{(14,16)z} + r_{(8,13)z})*cos(\\beta_{(1,2)}),                                                                                                                  0,                                                                                                                  0, -r_{(14,16)x} + r_{(8,13)x}, -r_{(14,16)y} + r_{(8,13)y}, -r_{(14,16)z} + r_{(8,13)z},                 0,                 0,                 0,                 0,                 0,                 0,                          0,                          0,                          0,                           0,                           0,                           0, -r_{(14,16)x} + r_{(8,13)x}, -r_{(14,16)y} + r_{(8,13)y}, -r_{(14,16)z} + r_{(8,13)z},                                                                                                                       0,                                                                                                                                                                                                                                                                                                                                                                    0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                   0,                                         0]])]'
    
def test_spatial_6CPU():
    A = numpy.matrix('9 3 0 3 0 3 0 0;0 9 2 0 0 0 0 0;0 1 9 0 0 0 0 5;0 0 0 9 2 0 0 0;0 0 0 1 9 0 0 5;0 0 0 0 0 9 2 0;0 0 0 0 0 1 9 5;0 0 0 0 0 0 0 9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), 0, 0],\n[sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}), 0, 0],\n[                  cos(\\beta_{(2,3)}), 0, 0],\n[                                   0, 0, 0],\n[                                   0, 0, 0],\n[                                   0, 0, 0]]), Matrix([\n[                  -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), 0, 0, 0, 0,                   (-a_y + r_{(3,8)y})*cos(\\beta_{(3,8)}) + (a_z - r_{(3,8)z})*sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}),                                                                              (-a_y + r_{(3,8)y})/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)) - (a_z - r_{(3,8)z})*sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})), 0, 0, 0, 0],\n[                   (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), 0, 0, 0, 0,                   (a_x - r_{(3,8)x})*cos(\\beta_{(3,8)}) + (-a_z + r_{(3,8)z})*sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}),                                                                              (a_x - r_{(3,8)x})/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)) - (-a_z + r_{(3,8)z})*cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})), 0, 0, 0, 0],\n[-(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                   cos(\\beta_{(1,2)}), 0, 0, 0, 0, (-a_x + r_{(3,8)x})*sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}) + (a_y - r_{(3,8)y})*sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}), -(-a_x + r_{(3,8)x})*sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})) - (a_y - r_{(3,8)y})*cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})), 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                    0, 0, 0, 0, 0,                                                                               sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}),                                                                                                                                                                                                -cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})), 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                    0, 0, 0, 0, 0,                                                                               sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}),                                                                                                                                                                                                -sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})), 0, 0, 0, 0],\n[                                                                                                cos(\\beta_{(1,2)}),                                    0, 0, 0, 0, 0,                                                                                                 cos(\\beta_{(3,8)}),                                                                                                                                                                                                                                                                           1/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)), 0, 0, 0, 0]]), Matrix([\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}), sin(\\beta_{(4,5)})*cos(\\phi_{(4,5)}),                                    0],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}), sin(\\beta_{(4,5)})*sin(\\phi_{(4,5)}),                                    0],\n[                  -cos(\\beta_{(2,3)}),                   cos(\\beta_{(4,5)}),                                    0],\n[-sin(\\beta_{(2,3)})*cos(\\phi_{(2,3)}),                                    0, sin(\\beta_{(6,7)})*cos(\\phi_{(6,7)})],\n[-sin(\\beta_{(2,3)})*sin(\\phi_{(2,3)}),                                    0, sin(\\beta_{(6,7)})*sin(\\phi_{(6,7)})],\n[                  -cos(\\beta_{(2,3)}),                                    0,                   cos(\\beta_{(6,7)})],\n[                                    0,                                    0,                                    0],\n[                                    0,                                    0,                                    0],\n[                                    0,                                    0,                                    0],\n[                                    0,                                    0,                                    0],\n[                                    0,                                    0,                                    0],\n[                                    0,                                    0,                                    0]]), Matrix([\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                   -(a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}), sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                                                                                                  0,                                    0,                   (a_y - r_{(3,8)y})*cos(\\beta_{(3,8)}) + (-a_z + r_{(3,8)z})*sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}),                                                                              (a_y - r_{(3,8)y})/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)) - (-a_z + r_{(3,8)z})*sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                   (-a_y + r_{(5,8)y})*cos(\\beta_{(5,8)}) + (a_z - r_{(5,8)z})*sin(\\beta_{(5,8)})*sin(\\phi_{(5,8)}),                                                                              (-a_y + r_{(5,8)y})/sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2)) - (a_z - r_{(5,8)z})*sin(\\delta_{(5,8)})/(sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2))*cos(\\delta_{(5,8)} - \\phi_{(5,8)})*tan(\\beta_{(5,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                    (a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                                                                                                                  0,                                    0,                   (-a_x + r_{(3,8)x})*cos(\\beta_{(3,8)}) + (a_z - r_{(3,8)z})*sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}),                                                                              (-a_x + r_{(3,8)x})/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)) - (a_z - r_{(3,8)z})*cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                   (a_x - r_{(5,8)x})*cos(\\beta_{(5,8)}) + (-a_z + r_{(5,8)z})*sin(\\beta_{(5,8)})*cos(\\phi_{(5,8)}),                                                                              (a_x - r_{(5,8)x})/sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2)) - (-a_z + r_{(5,8)z})*cos(\\delta_{(5,8)})/(sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2))*cos(\\delta_{(5,8)} - \\phi_{(5,8)})*tan(\\beta_{(5,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                   -cos(\\beta_{(1,2)}), -(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) + (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                   cos(\\beta_{(1,4)}),                                                                                                                  0,                                    0, (a_x - r_{(3,8)x})*sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}) + (-a_y + r_{(3,8)y})*sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}), -(a_x - r_{(3,8)x})*sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})) - (-a_y + r_{(3,8)y})*cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})), (-a_x + r_{(5,8)x})*sin(\\beta_{(5,8)})*sin(\\phi_{(5,8)}) + (a_y - r_{(5,8)y})*sin(\\beta_{(5,8)})*cos(\\phi_{(5,8)}), -(-a_x + r_{(5,8)x})*sin(\\delta_{(5,8)})/(sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2))*cos(\\delta_{(5,8)} - \\phi_{(5,8)})*tan(\\beta_{(5,8)})) - (a_y - r_{(5,8)y})*cos(\\delta_{(5,8)})/(sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2))*cos(\\delta_{(5,8)} - \\phi_{(5,8)})*tan(\\beta_{(5,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0],\n[                  (a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}), -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                                                                                                  0,                                    0,                   -(a_y - r_{(1,6)y})*cos(\\beta_{(1,6)}) + (a_z - r_{(1,6)z})*sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}), sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),                   (a_y - r_{(3,8)y})*cos(\\beta_{(3,8)}) + (-a_z + r_{(3,8)z})*sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}),                                                                              (a_y - r_{(3,8)y})/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)) - (-a_z + r_{(3,8)z})*sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0,                   (-a_y + r_{(7,8)y})*cos(\\beta_{(7,8)}) + (a_z - r_{(7,8)z})*sin(\\beta_{(7,8)})*sin(\\phi_{(7,8)}),                                                                              (-a_y + r_{(7,8)y})/sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2)) - (a_z - r_{(7,8)z})*sin(\\delta_{(7,8)})/(sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))*cos(\\delta_{(7,8)} - \\phi_{(7,8)})*tan(\\beta_{(7,8)}))],\n[                 -(a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}), -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                                                                                                  0,                                    0,                    (a_x - r_{(1,6)x})*cos(\\beta_{(1,6)}) - (a_z - r_{(1,6)z})*sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}), sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}),                   (-a_x + r_{(3,8)x})*cos(\\beta_{(3,8)}) + (a_z - r_{(3,8)z})*sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}),                                                                              (-a_x + r_{(3,8)x})/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)) - (a_z - r_{(3,8)z})*cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0,                   (a_x - r_{(7,8)x})*cos(\\beta_{(7,8)}) + (-a_z + r_{(7,8)z})*sin(\\beta_{(7,8)})*cos(\\phi_{(7,8)}),                                                                              (a_x - r_{(7,8)x})/sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2)) - (-a_z + r_{(7,8)z})*cos(\\delta_{(7,8)})/(sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))*cos(\\delta_{(7,8)} - \\phi_{(7,8)})*tan(\\beta_{(7,8)}))],\n[(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) - (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                   -cos(\\beta_{(1,2)}),                                                                                                                  0,                                    0, -(a_x - r_{(1,6)x})*sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}) + (a_y - r_{(1,6)y})*sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),                   cos(\\beta_{(1,6)}), (a_x - r_{(3,8)x})*sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}) + (-a_y + r_{(3,8)y})*sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}), -(a_x - r_{(3,8)x})*sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})) - (-a_y + r_{(3,8)y})*cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0, (-a_x + r_{(7,8)x})*sin(\\beta_{(7,8)})*sin(\\phi_{(7,8)}) + (a_y - r_{(7,8)y})*sin(\\beta_{(7,8)})*cos(\\phi_{(7,8)}), -(-a_x + r_{(7,8)x})*sin(\\delta_{(7,8)})/(sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))*cos(\\delta_{(7,8)} - \\phi_{(7,8)})*tan(\\beta_{(7,8)})) - (a_y - r_{(7,8)y})*cos(\\delta_{(7,8)})/(sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))*cos(\\delta_{(7,8)} - \\phi_{(7,8)})*tan(\\beta_{(7,8)}))],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                     0,                                                                               sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                                    0,                                                                                                                  0,                                    0,                                                                              -sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}),                                                                                                                                                                                                 cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                               sin(\\beta_{(5,8)})*cos(\\phi_{(5,8)}),                                                                                                                                                                                                -cos(\\delta_{(5,8)})/(sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2))*cos(\\delta_{(5,8)} - \\phi_{(5,8)})*tan(\\beta_{(5,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                     0,                                                                               sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                                    0,                                                                                                                  0,                                    0,                                                                              -sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}),                                                                                                                                                                                                 sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                               sin(\\beta_{(5,8)})*sin(\\phi_{(5,8)}),                                                                                                                                                                                                -sin(\\delta_{(5,8)})/(sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2))*cos(\\delta_{(5,8)} - \\phi_{(5,8)})*tan(\\beta_{(5,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0],\n[                                                                                              -cos(\\beta_{(1,2)}),                                     0,                                                                                                 cos(\\beta_{(1,4)}),                                    0,                                                                                                                  0,                                    0,                                                                                                -cos(\\beta_{(3,8)}),                                                                                                                                                                                                                                                                          -1/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)),                                                                                                 cos(\\beta_{(5,8)}),                                                                                                                                                                                                                                                                           1/sqrt(1 + 1/(cos(\\delta_{(5,8)} - \\phi_{(5,8)})**2*tan(\\beta_{(5,8)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0],\n[                                                                            -sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}),                                     0,                                                                                                                  0,                                    0,                                                                               sin(\\beta_{(1,6)})*cos(\\phi_{(1,6)}),                                    0,                                                                              -sin(\\beta_{(3,8)})*cos(\\phi_{(3,8)}),                                                                                                                                                                                                 cos(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                               sin(\\beta_{(7,8)})*cos(\\phi_{(7,8)}),                                                                                                                                                                                                -cos(\\delta_{(7,8)})/(sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))*cos(\\delta_{(7,8)} - \\phi_{(7,8)})*tan(\\beta_{(7,8)}))],\n[                                                                            -sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}),                                     0,                                                                                                                  0,                                    0,                                                                               sin(\\beta_{(1,6)})*sin(\\phi_{(1,6)}),                                    0,                                                                              -sin(\\beta_{(3,8)})*sin(\\phi_{(3,8)}),                                                                                                                                                                                                 sin(\\delta_{(3,8)})/(sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2))*cos(\\delta_{(3,8)} - \\phi_{(3,8)})*tan(\\beta_{(3,8)})),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                               sin(\\beta_{(7,8)})*sin(\\phi_{(7,8)}),                                                                                                                                                                                                -sin(\\delta_{(7,8)})/(sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))*cos(\\delta_{(7,8)} - \\phi_{(7,8)})*tan(\\beta_{(7,8)}))],\n[                                                                                              -cos(\\beta_{(1,2)}),                                     0,                                                                                                                  0,                                    0,                                                                                                 cos(\\beta_{(1,6)}),                                    0,                                                                                                -cos(\\beta_{(3,8)}),                                                                                                                                                                                                                                                                          -1/sqrt(1 + 1/(cos(\\delta_{(3,8)} - \\phi_{(3,8)})**2*tan(\\beta_{(3,8)})**2)),                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                 cos(\\beta_{(7,8)}),                                                                                                                                                                                                                                                                           1/sqrt(1 + 1/(cos(\\delta_{(7,8)} - \\phi_{(7,8)})**2*tan(\\beta_{(7,8)})**2))]])]'

def test_spatial_R2SR():
    A = numpy.matrix('9 1 0 1;1 9 4 0;0 0 9 4;0 0 0 9')
    jac = jacobian(A, robot_type = 'spatial')
    jac_func = jac.get_jacobian_function()
    assert str([jac.Ja, jac.Jp, jac.Aa, jac.Ap]) == '[Matrix([\n[0],\n[0],\n[0],\n[0],\n[0],\n[0]]), Matrix([\n[                  -(a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                   (a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[-(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) + (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                                                                              sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}), 0, 0, 0, 0, 0, 0],\n[                                                                                                cos(\\beta_{(1,4)}), 0, 0, 0, 0, 0, 0]]), Matrix([\n[                                                                              -(a_y - r_{(1,2)y})*cos(\\beta_{(1,2)}) + (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)})],\n[                                                                               (a_x - r_{(1,2)x})*cos(\\beta_{(1,2)}) - (a_z - r_{(1,2)z})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)})],\n[                                                            -(a_x - r_{(1,2)x})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (a_y - r_{(1,2)y})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)})],\n[                                                                                                                                          sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)})],\n[                                                                                                                                          sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)})],\n[                                                                                                                                                            cos(\\beta_{(1,2)})],\n[(r_{(2,3)x} - r_{(3,4)x})*sin(\\beta_{(1,2)})*cos(\\phi_{(1,2)}) + (r_{(2,3)y} - r_{(3,4)y})*sin(\\beta_{(1,2)})*sin(\\phi_{(1,2)}) + (r_{(2,3)z} - r_{(3,4)z})*cos(\\beta_{(1,2)})]]), Matrix([\n[                  (a_y - r_{(1,4)y})*cos(\\beta_{(1,4)}) - (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                       0,        a_z - r_{(2,3)z},       -a_y + r_{(2,3)y},                 0,  a_z - r_{(3,4)z}, -a_y + r_{(3,4)y}],\n[                 -(a_x - r_{(1,4)x})*cos(\\beta_{(1,4)}) + (a_z - r_{(1,4)z})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),       -a_z + r_{(2,3)z},                       0,        a_x - r_{(2,3)x}, -a_z + r_{(3,4)z},                 0,  a_x - r_{(3,4)x}],\n[(a_x - r_{(1,4)x})*sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}) - (a_y - r_{(1,4)y})*sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),        a_y - r_{(2,3)y},       -a_x + r_{(2,3)x},                       0,  a_y - r_{(3,4)y}, -a_x + r_{(3,4)x},                 0],\n[                                                                            -sin(\\beta_{(1,4)})*cos(\\phi_{(1,4)}),                       1,                       0,                       0,                 1,                 0,                 0],\n[                                                                            -sin(\\beta_{(1,4)})*sin(\\phi_{(1,4)}),                       0,                       1,                       0,                 0,                 1,                 0],\n[                                                                                              -cos(\\beta_{(1,4)}),                       0,                       0,                       1,                 0,                 0,                 1],\n[                                                                                                                0, r_{(2,3)x} - r_{(3,4)x}, r_{(2,3)y} - r_{(3,4)y}, r_{(2,3)z} - r_{(3,4)z},                 0,                 0,                 0]])]'
